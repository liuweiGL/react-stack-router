{"version":3,"file":"react-mobile-router.cjs.js","sources":["../src/context/LocationContext.tsx","../src/context/NavigationContext.tsx","../src/utils/component.ts","../src/utils/constants.ts","../src/utils/uid.ts","../src/utils/url.ts","../src/utils/diagnosis.ts","../src/core/route.ts","../src/core/history.ts","../src/utils/function.ts","../src/core/stack.ts","../src/hooks/useForceUpdate.ts","../src/hooks/useStack.ts","../src/hooks/useUnmount.ts","../src/hooks/useWatch.ts","../src/context/PageContext.tsx","../src/core/RouterPage.tsx","../src/core/Router.tsx","../src/hooks/useNavigation.ts","../src/utils/event.ts","../src/core/navigate.ts","../src/core/Navigator.tsx","../src/hooks/useRouter.ts","../src/hooks/useLocation.ts","../src/hooks/usePage.ts","../src/hooks/useDidHide.ts","../src/hooks/useDidShow.ts","../src/index.ts"],"sourcesContent":["import { createContext, PropsWithChildren, ProviderProps } from 'react'\r\n\r\nimport { Location } from 'history'\r\n\r\ntype LocationContextState = {\r\n  location: Location\r\n}\r\n\r\nexport const LocationContext = createContext<LocationContextState>({} as any)\r\n\r\nexport const LocationProvider = (\r\n  props: ProviderProps<LocationContextState>\r\n) => {\r\n  return <LocationContext.Provider {...props} />\r\n}\r\n","import { createContext, ProviderProps } from 'react'\r\n\r\nimport { ProHistory } from '../core/history'\r\n\r\ntype NavigationContextState = {\r\n  navigator: ProHistory\r\n}\r\n\r\nexport const NavigationContext = createContext<NavigationContextState>(\r\n  {} as any\r\n)\r\n\r\nexport const NavigationProvider = (\r\n  props: ProviderProps<NavigationContextState>\r\n) => {\r\n  return <NavigationContext.Provider {...props} />\r\n}\r\n","import { LazyComponent } from 'src/core/route'\r\n\r\nexport const isClassComponent = (component: any) => {\r\n  return !!Object.getPrototypeOf(component)?.isReactComponent\r\n}\r\n\r\nconst importRegexp = /import\\s?\\(/\r\nexport const isLazyComponent = (component: any): component is LazyComponent => {\r\n  if (isClassComponent(component)) {\r\n    return false\r\n  }\r\n\r\n  const str = String(component).trim()\r\n\r\n  return str.startsWith('(') && str.includes('=>') && importRegexp.test(str)\r\n}\r\n\r\nexport const loadLazyComponent = async (component: () => Promise<any>) => {\r\n  const res = await component()\r\n\r\n  if (res && isESModule(res)) {\r\n    return res.default\r\n  }\r\n\r\n  return res\r\n}\r\n\r\nexport const isESModule = (obj: any): obj is { default: any } => {\r\n  return obj.__esModule || (hasSymbol && obj[Symbol.toStringTag] === 'Module')\r\n}\r\n\r\nexport const hasSymbol =\r\n  typeof Symbol === 'function' && typeof Symbol.toStringTag === 'symbol'\r\n","export const PAGE_KEY = '_pageKey'\r\n","let IDX = 36,\r\n  HEX = ''\r\nwhile (IDX--) HEX += IDX.toString(36)\r\n\r\nexport function uid(len?: number) {\r\n  let str = '',\r\n    num = len || 11\r\n  while (num--) str += HEX[(Math.random() * 36) | 0]\r\n  return str\r\n}\r\n","import { parsePath, Path } from 'history'\r\n\r\nimport { PAGE_KEY } from './constants'\r\nimport { uid } from './uid'\r\n\r\nexport const containBasename = (basename: string, pathname: string) => {\r\n  return pathname.toLowerCase().startsWith(basename.toLowerCase())\r\n}\r\n\r\nexport const stripBasename = (basename: string, pathname: string) => {\r\n  if (basename === '/') return pathname\r\n\r\n  if (!containBasename(basename, pathname)) {\r\n    return null\r\n  }\r\n\r\n  return pathname.slice(basename.length) || '/'\r\n}\r\n\r\nexport const joinPaths = (...paths: string[]) => {\r\n  return paths.join('/').replace(/\\/\\/+/g, '/')\r\n}\r\n\r\nexport const normalizePath = (pathname: string) => {\r\n  return pathname.replace(/\\/+$/, '').replace(/^\\/*/, '/')\r\n}\r\n\r\nexport const parseParams = (url?: string) => {\r\n  const result: Record<string, string> = {}\r\n\r\n  if (!url) {\r\n    return result\r\n  }\r\n\r\n  const { search } = parsePath(url)\r\n  const searchParams = new URLSearchParams(search)\r\n\r\n  for (const [key, value] of searchParams.entries()) {\r\n    result[key] = value\r\n  }\r\n\r\n  return result\r\n}\r\n\r\nexport const stringifyParams = (params: Record<any, any>) => {\r\n  const searchParams = new URLSearchParams()\r\n\r\n  for (const [key, value] of Object.entries(params)) {\r\n    searchParams.append(key, value)\r\n  }\r\n\r\n  return searchParams.toString()\r\n}\r\n\r\nexport const getPageKey = ({ search }: Partial<Path>) => {\r\n  if (!search) {\r\n    return undefined\r\n  }\r\n\r\n  const params = parseParams(search)\r\n\r\n  const pageKey = params[PAGE_KEY]\r\n\r\n  return typeof pageKey === 'string' ? pageKey : undefined\r\n}\r\n\r\nexport const setPageKey = (location: Partial<Path>) => {\r\n  const params = parseParams(location.search)\r\n  const search = stringifyParams({\r\n    ...params,\r\n    [PAGE_KEY]: uid()\r\n  })\r\n\r\n  return {\r\n    ...location,\r\n    search\r\n  }\r\n}\r\n","/**\r\n * 为变量添加断言\r\n *\r\n * 注意：不要使用箭头函数声明\r\n * @see https://github.com/microsoft/TypeScript/issues/34523\r\n *  */\r\nexport function assert(cond: any, message: string): asserts cond {\r\n  if (!cond) throw new Error(message)\r\n}\r\n\r\nfunction log(method: 'warn' | 'error', cond: any, message: string): void {\r\n  if (cond) {\r\n    // eslint-disable-next-line no-console\r\n    if (typeof console !== 'undefined') console[method](message)\r\n\r\n    try {\r\n      // Welcome to debugging React Router!\r\n      //\r\n      // This error is thrown as a convenience so you can more easily\r\n      // find the source for a warning that appears in the console by\r\n      // enabling \"pause on exceptions\" in your JavaScript debugger.\r\n      throw new Error(message)\r\n      // eslint-disable-next-line no-empty\r\n    } catch (e) {}\r\n  }\r\n}\r\n\r\nexport function warning(cond: any, message: string): void {\r\n  log('warn', cond, message)\r\n}\r\n\r\nexport function error(cond: any, message: string): void {\r\n  log('error', cond, message)\r\n}\r\n","import {\r\n  ComponentClass,\r\n  ComponentType,\r\n  FunctionComponent,\r\n  ReactNode\r\n} from 'react'\r\n\r\nimport { warning } from '../utils/diagnosis'\r\n\r\nexport type LazyComponent = () => Promise<{\r\n  default: ComponentType<any>\r\n}>\r\n\r\nexport type RouteComponent = FunctionComponent | ComponentClass | LazyComponent\r\n\r\ntype BaseRoute<Meta> = {\r\n  // 是否是首页\r\n  index?: boolean\r\n  // 唯一标识\r\n  name?: string\r\n  path: string\r\n  meta?: Meta\r\n}\r\n\r\nexport type PageRoute<Meta = any> = BaseRoute<Meta> & {\r\n  type?: 'page'\r\n}\r\n\r\nexport type TabRoute<Meta = any> = BaseRoute<Meta> & {\r\n  type: 'tab'\r\n  icon?: ReactNode\r\n}\r\n\r\nexport type RouteRaw<Meta = any> = PageRoute<Meta> | TabRoute<Meta>\r\n\r\nexport type Route<Meta = any> = RouteRaw<Meta> & {\r\n  component: RouteComponent\r\n}\r\n\r\nexport type RouteRecord<Meta = any> = RouteRaw<Meta> & {\r\n  component: Exclude<RouteComponent, LazyComponent>\r\n}\r\n\r\nexport const isTabRoute = (route: RouteRaw): route is TabRoute => {\r\n  return route.type === 'tab'\r\n}\r\n\r\nexport const isPageRoute = (route: RouteRaw): route is PageRoute => {\r\n  return route.type === undefined || route.type === 'page'\r\n}\r\n\r\nexport const isSameRoute = (route1: RouteRaw, route2: RouteRaw) => {\r\n  return route1.name === route2.name || route1.path === route2.path\r\n}\r\n\r\nexport const matchRoute = (routes: Route[], nameOrPath?: string) => {\r\n  let route: Route | undefined\r\n\r\n  if (nameOrPath) {\r\n    route = routes.find(\r\n      ({ name, path }) => name === nameOrPath || path === nameOrPath\r\n    )\r\n  }\r\n\r\n  warning(\r\n    !route,\r\n    `Can not find the route when name or path is  \\`${nameOrPath}\\` `\r\n  )\r\n\r\n  return route\r\n}\r\n","import { createPath, History, parsePath, Path, To, Update } from 'history'\r\n\r\nimport { isLazyComponent, loadLazyComponent } from '../utils/component'\r\nimport { Noop } from '../utils/function'\r\nimport {\r\n  getPageKey,\r\n  joinPaths,\r\n  normalizePath,\r\n  setPageKey,\r\n  stripBasename\r\n} from '../utils/url'\r\n\r\nimport { isTabRoute, matchRoute, Route, RouteRecord } from './route'\r\nimport { Stack } from './stack'\r\n\r\ntype ProState = {\r\n  blockerId: number\r\n}\r\n\r\nexport type ProTo =\r\n  | To\r\n  | {\r\n      name: string\r\n    }\r\n\r\nexport type ProUpdate = Update & {\r\n  route: RouteRecord\r\n}\r\n\r\nexport type ProListener = (options: ProUpdate) => void\r\n\r\nexport type ProBlocker = (options: ProUpdate) => boolean | undefined\r\n\r\nexport type HistoryProps = {\r\n  basename: string\r\n  history: History\r\n  routes: Route[]\r\n  stack: Stack\r\n}\r\n\r\nexport class ProHistory {\r\n  public basename: string\r\n  private history: History\r\n  private routes: Route[]\r\n  private stack: Stack\r\n\r\n  private routeRecordMap: Map<string, RouteRecord>\r\n  private blockerMap: Map<number, ProBlocker>\r\n\r\n  private listeners: ProListener[] = []\r\n  private unlisteners: Noop[] = []\r\n\r\n  constructor({ basename, history, routes, stack }: HistoryProps) {\r\n    this.basename = normalizePath(basename)\r\n    this.routes = routes\r\n    this.stack = stack\r\n    this.history = history\r\n    this.routeRecordMap = new Map()\r\n    this.blockerMap = new Map()\r\n\r\n    this.initSubscriber()\r\n    this.initWatcher()\r\n    this.loadIndexPage()\r\n  }\r\n\r\n  get location() {\r\n    return this.history.location\r\n  }\r\n\r\n  get currentRoute() {\r\n    return this.stack.current\r\n  }\r\n\r\n  get stackSnapshoot() {\r\n    return this.stack.items.slice()\r\n  }\r\n\r\n  private get indexRoute() {\r\n    return this.routes.find(item => item.index) || this.routes[0]\r\n  }\r\n\r\n  private async resolveRouteRecord(pathname: string) {\r\n    const route = matchRoute(this.routes, pathname)\r\n\r\n    if (!route) {\r\n      return\r\n    }\r\n\r\n    const { path, component } = route\r\n    if (this.routeRecordMap.has(path)) {\r\n      return this.routeRecordMap.get(path)\r\n    }\r\n\r\n    let routeRecord: RouteRecord\r\n\r\n    if (isLazyComponent(component)) {\r\n      const resolvedComponent = await loadLazyComponent(component)\r\n\r\n      if (!resolvedComponent) {\r\n        throw new Error(`Couldn't resolve component  at \"${path}\"`)\r\n      }\r\n\r\n      routeRecord = {\r\n        ...route,\r\n        component: resolvedComponent\r\n      }\r\n    } else {\r\n      routeRecord = {\r\n        ...route,\r\n        component\r\n      }\r\n    }\r\n\r\n    this.routeRecordMap.set(path, routeRecord)\r\n\r\n    return routeRecord\r\n  }\r\n\r\n  /**\r\n   * 包装 history 的 listen 事件，处理 basename\r\n   */\r\n  private initSubscriber() {\r\n    const unlistener = this.history.listen(async options => {\r\n      const {\r\n        location: { pathname, state }\r\n      } = options\r\n\r\n      const path = stripBasename(this.basename, pathname)\r\n\r\n      if (!path) {\r\n        return\r\n      }\r\n\r\n      const route = await this.resolveRouteRecord(path)\r\n\r\n      if (!route) {\r\n        return\r\n      }\r\n\r\n      const proOptions = {\r\n        ...options,\r\n        route\r\n      }\r\n\r\n      if (state) {\r\n        const { blockerId } = state as ProState\r\n\r\n        const blocker = this.blockerMap.get(blockerId)\r\n\r\n        if (blocker && blocker(proOptions) === false) {\r\n          this.blockerMap.delete(blockerId)\r\n          return\r\n        }\r\n      }\r\n\r\n      this.listeners.forEach(listen => {\r\n        listen(proOptions)\r\n      })\r\n    })\r\n\r\n    this.unlisteners.push(unlistener)\r\n  }\r\n\r\n  /**\r\n   * 当 history 变化时维护路由\r\n   */\r\n  private initWatcher() {\r\n    this.listen(({ route, location }) => {\r\n      const url = createPath(location)\r\n\r\n      const pageKey = getPageKey(location)\r\n\r\n      if (pageKey) {\r\n        const stackRoute = {\r\n          pageKey,\r\n          url,\r\n          ...route\r\n        }\r\n\r\n        if (isTabRoute(route)) {\r\n          this.stack.switchTab(stackRoute)\r\n        } else {\r\n          this.stack.jumpPage(stackRoute)\r\n        }\r\n      } else {\r\n        this.history.replace(setPageKey(location))\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 加载首页\r\n   */\r\n  private loadIndexPage() {\r\n    this.replace(this.indexRoute.path)\r\n  }\r\n\r\n  listen(listener: ProListener) {\r\n    this.listeners.push(listener)\r\n\r\n    const index = this.listeners.length - 1\r\n\r\n    return () => {\r\n      this.listeners.splice(index, 1)\r\n    }\r\n  }\r\n\r\n  private resolveTo(to: ProTo) {\r\n    let path: Partial<Path> | undefined\r\n\r\n    if (typeof to === 'string') {\r\n      path = parsePath(to)\r\n    } else if ('pathname' in to) {\r\n      path = to\r\n    } else if ('name' in to) {\r\n      const route = matchRoute(this.routes, to.name)\r\n\r\n      path = route\r\n        ? {\r\n            pathname: route.path\r\n          }\r\n        : undefined\r\n    }\r\n\r\n    if (path?.pathname) {\r\n      path.pathname = joinPaths(this.basename, path.pathname)\r\n      path = setPageKey(path)\r\n    }\r\n\r\n    return path\r\n  }\r\n\r\n  push(to: ProTo, blocker?: ProBlocker) {\r\n    const result = this.resolveTo(to)\r\n\r\n    if (result) {\r\n      let state\r\n      if (blocker) {\r\n        const blockerId = Date.now()\r\n        state = { blockerId }\r\n        this.blockerMap.set(blockerId, blocker)\r\n      }\r\n\r\n      this.history.push(result, state)\r\n    }\r\n  }\r\n\r\n  replace(to: ProTo) {\r\n    const result = this.resolveTo(to)\r\n\r\n    if (result) {\r\n      this.stack.pop()\r\n      this.history.replace(result)\r\n    }\r\n  }\r\n\r\n  reset() {\r\n    this.stack.clear()\r\n  }\r\n\r\n  back(delta = 1) {\r\n    const prePage = this.stack.getLastItem(delta)\r\n\r\n    this.history.replace(prePage.url)\r\n  }\r\n\r\n  createHref(to: ProTo) {\r\n    const result = this.resolveTo(to)\r\n\r\n    if (result) {\r\n      return this.history.createHref(result)\r\n    }\r\n\r\n    return undefined\r\n  }\r\n\r\n  destroy() {\r\n    this.unlisteners.forEach(item => item())\r\n  }\r\n}\r\n","export type Noop<T = any> = (...args: T[]) => any\r\n\r\nlet timer: any\r\nexport const debounce = (fn: Noop, wait: number) => {\r\n  if (timer) {\r\n    clearTimeout(timer)\r\n  }\r\n\r\n  timer = setTimeout(fn, wait)\r\n}\r\n","import { debounce } from '../utils/function'\r\n\r\nimport { isSameRoute, RouteRecord } from './route'\r\n\r\ntype Scheduler = () => void\r\n\r\nexport type StackRoute = RouteRecord & {\r\n  pageKey?: string\r\n\r\n  // 完整的地址，用于返回时恢复地址栏地址\r\n  url: string\r\n}\r\n\r\nconst createReactiveArray = (scheduler: Scheduler) => {\r\n  const initial: StackRoute[] = []\r\n\r\n  return new Proxy(initial, {\r\n    get(target, key: any) {\r\n      return target[key]\r\n    },\r\n    set(target, key: any, value) {\r\n      target[key] = value\r\n\r\n      debounce(scheduler, 50)\r\n\r\n      return true\r\n    }\r\n  })\r\n}\r\n\r\nexport class Stack {\r\n  private tabs: StackRoute[]\r\n  private pages: StackRoute[]\r\n\r\n  constructor(scheduler: Scheduler) {\r\n    this.tabs = createReactiveArray(scheduler)\r\n    this.pages = createReactiveArray(scheduler)\r\n  }\r\n\r\n  get current() {\r\n    return this.items[this.items.length - 1]\r\n  }\r\n\r\n  get items() {\r\n    return [...this.tabs, ...this.pages]\r\n  }\r\n\r\n  private containsTab(item: StackRoute) {\r\n    return this.tabs.some(tab => isSameRoute(tab, item))\r\n  }\r\n\r\n  private findPageIndex(item: StackRoute) {\r\n    if (!item.pageKey) {\r\n      return -1\r\n    }\r\n\r\n    return this.pages.findIndex(page => page.pageKey === item.pageKey)\r\n  }\r\n\r\n  /**\r\n   * 从右往左取值，下标从 0 开始\r\n   */\r\n  getLastItem(delta: number) {\r\n    return this.items[this.items.length - delta - 1]\r\n  }\r\n\r\n  switchTab(item: StackRoute) {\r\n    if (this.containsTab(item)) {\r\n      this.tabs.sort(tab => (isSameRoute(tab, item) ? -1 : 0))\r\n    } else {\r\n      this.tabs.push({ ...item })\r\n    }\r\n\r\n    this.clear()\r\n  }\r\n\r\n  jumpPage(item: StackRoute) {\r\n    const pageIndex = this.findPageIndex(item)\r\n\r\n    if (pageIndex > -1) {\r\n      this.pages.splice(pageIndex + 1, this.pages.length - pageIndex - 1)\r\n    } else {\r\n      this.pages.push({ ...item })\r\n    }\r\n  }\r\n\r\n  pop() {\r\n    this.pages.pop()\r\n  }\r\n\r\n  clear() {\r\n    this.pages.splice(0, this.pages.length)\r\n  }\r\n}\r\n","import { useCallback, useState } from 'react'\r\n\r\nexport const useForceUpdate = () => {\r\n  const [, setState] = useState({})\r\n\r\n  return useCallback(() => setState({}), [])\r\n}\r\n","import { useMemo } from 'react'\r\n\r\nimport { Stack } from '../core/stack'\r\n\r\nimport { useForceUpdate } from './useForceUpdate'\r\n\r\nexport const useStack = () => {\r\n  const scheduler = useForceUpdate()\r\n\r\n  return useMemo(() => new Stack(scheduler), [])\r\n}\r\n","import { useEffect } from 'react'\r\n\r\nexport const useUnmount = (cb: () => void) => {\r\n  useEffect(() => {\r\n    return cb\r\n  }, [])\r\n}\r\n","import { useEffect, useRef, useState } from 'react'\r\n\r\nimport { History } from 'history'\r\n\r\nimport { ProHistory } from '../core/history'\r\nimport { Route } from '../core/route'\r\n\r\nimport { useStack } from './useStack'\r\nimport { useUnmount } from './useUnmount'\r\n\r\nexport type UseHistoryProps = {\r\n  basename: string\r\n  history: History\r\n  routes: Route[]\r\n}\r\n\r\nexport const useWatch = ({ basename, history, routes }: UseHistoryProps) => {\r\n  const stack = useStack()\r\n\r\n  // 不要使用 useMemo 不然有可能导致多个 history 实例操作同一个 stack\r\n  const ref = useRef<ProHistory>()\r\n\r\n  if (!ref.current) {\r\n    ref.current = new ProHistory({ basename, history, routes, stack })\r\n  }\r\n\r\n  const proHistory = ref.current\r\n\r\n  const [location, setLocation] = useState(history.location)\r\n\r\n  useEffect(() => {\r\n    proHistory.listen(function c({ location }) {\r\n      setLocation(location)\r\n    })\r\n  }, [proHistory])\r\n\r\n  useUnmount(() => {\r\n    proHistory.destroy()\r\n  })\r\n\r\n  return {\r\n    location,\r\n    history: proHistory,\r\n    matches: stack.items\r\n  }\r\n}\r\n","import { createContext } from 'react'\r\n\r\nexport type PageStatus = 'show' | 'hide'\r\n\r\nexport type PageContextState = {\r\n  status?: PageStatus\r\n}\r\n\r\nexport const PageContext = createContext<PageContextState>({})\r\n","import { CSSProperties, ReactNode } from 'react'\r\nimport { PageContext } from 'src/context/PageContext'\r\n\r\nexport type RouterPageProps = {\r\n  status: 'show' | 'hide'\r\n  children?: ReactNode\r\n}\r\n\r\nconst hideStyle: CSSProperties = Object.freeze({\r\n  display: 'none'\r\n})\r\n\r\nconst RouterPage = ({ status, children }: RouterPageProps) => {\r\n  return (\r\n    <PageContext.Provider value={{ status }}>\r\n      <div\r\n        children={children}\r\n        style={status === 'hide' ? hideStyle : undefined}\r\n      />\r\n    </PageContext.Provider>\r\n  )\r\n}\r\n\r\nexport default RouterPage\r\n","import { useMemo } from 'react'\r\n\r\nimport { createBrowserHistory, createHashHistory, History } from 'history'\r\n\r\nimport { LocationProvider } from '../context/LocationContext'\r\nimport { NavigationProvider } from '../context/NavigationContext'\r\nimport { useWatch } from '../hooks/useWatch'\r\n\r\nimport { Route } from './route'\r\nimport RouterPage from './RouterPage'\r\nimport { StackRoute } from './stack'\r\n\r\nexport type RouterProps = {\r\n  basename?: string\r\n  history: History\r\n  routes: Route[]\r\n}\r\n\r\nconst renderRoutes = (routes: StackRoute[]) => {\r\n  return routes.map(({ pageKey, component: RouteComponent }, index) => {\r\n    const status = index === routes.length - 1 ? 'show' : 'hide'\r\n    return (\r\n      <RouterPage key={pageKey} status={status}>\r\n        <RouteComponent />\r\n      </RouterPage>\r\n    )\r\n  })\r\n}\r\n\r\nexport const Router = ({ basename = '/', history, routes }: RouterProps) => {\r\n  const {\r\n    matches,\r\n    location,\r\n    history: proHistory\r\n  } = useWatch({ basename, history, routes })\r\n\r\n  const children = renderRoutes(matches)\r\n\r\n  return (\r\n    <NavigationProvider value={{ navigator: proHistory }}>\r\n      <LocationProvider children={children} value={{ location }} />\r\n    </NavigationProvider>\r\n  )\r\n}\r\n\r\nexport type BrowserRouterProps = {\r\n  basename?: string\r\n  routes: Route[]\r\n}\r\n\r\nexport const BrowserRouter = ({ basename, routes }: BrowserRouterProps) => {\r\n  const history = useMemo(() => createBrowserHistory({ window }), [])\r\n\r\n  return <Router basename={basename} history={history} routes={routes} />\r\n}\r\n\r\nexport type HashRouterProps = BrowserRouterProps\r\n\r\nexport const HashRouter = ({ basename, routes }: HashRouterProps) => {\r\n  const history = useMemo(() => createHashHistory({ window }), [])\r\n\r\n  return <Router basename={basename} history={history} routes={routes} />\r\n}\r\n","import { useContext } from 'react'\r\n\r\nimport { NavigationContext } from '../context/NavigationContext'\r\n\r\nexport const useNavigation = () => {\r\n  return useContext(NavigationContext)\r\n}\r\n","import { MouseEvent } from 'react'\r\n\r\nexport const isModifiedEvent = (event: MouseEvent) => {\r\n  return !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey)\r\n}\r\n","import { ProHistory } from '../core/history'\r\nimport { error } from '../utils/diagnosis'\r\n\r\nimport { isTabRoute } from './route'\r\n\r\nexport type NavigateForwardOptions = {\r\n  type: 'navigateTo' | 'switchTab' | 'redirectTo' | 'reLaunch'\r\n  name?: string\r\n  url?: string\r\n}\r\n\r\nexport type NavigateBackOptions = {\r\n  type: 'navigateBack'\r\n  delta?: number\r\n}\r\n\r\nexport type NavigateOptions = {\r\n  navigator: ProHistory\r\n} & (NavigateForwardOptions | NavigateBackOptions)\r\n\r\nexport const navigate = async (options: NavigateOptions) => {\r\n  return new Promise<void>((resolve, reject) => {\r\n    const { navigator, type } = options\r\n\r\n    const unListen = navigator.listen(() => {\r\n      resolve()\r\n      unListen()\r\n    })\r\n\r\n    try {\r\n      if (type === 'navigateBack') {\r\n        const { delta } = options\r\n\r\n        navigator.back(delta)\r\n      } else {\r\n        const { name, url } = options\r\n        const to = name ? { name } : url\r\n\r\n        if (!to) {\r\n          return\r\n        }\r\n\r\n        if (type === 'navigateTo' || type === 'switchTab') {\r\n          navigator.push(to, ({ route }) => {\r\n            if (type === 'navigateTo' && isTabRoute(route)) {\r\n              error(\r\n                true,\r\n                `Use \\`switchTo\\` instead of \\`navigateTo\\` to switch the tabbar page：${route.path}`\r\n              )\r\n\r\n              return false\r\n            }\r\n          })\r\n        } else if (type === 'redirectTo') {\r\n          navigator.replace(to)\r\n        } else if (type === 'reLaunch') {\r\n          navigator.reset()\r\n          navigator.push(to)\r\n        }\r\n      }\r\n    } catch (error: any) {\r\n      reject(`${type}:fail ${error.message || error}`)\r\n    }\r\n  })\r\n}\r\n","import { CSSProperties, MouseEvent, ReactNode } from 'react'\r\n\r\nimport { useNavigation } from '../hooks/useNavigation'\r\nimport { isModifiedEvent } from '../utils/event'\r\n\r\nimport {\r\n  navigate,\r\n  NavigateBackOptions,\r\n  NavigateForwardOptions\r\n} from './navigate'\r\n\r\ntype ComponentProps = {\r\n  className?: string\r\n  style?: CSSProperties\r\n  title?: ReactNode\r\n  children?: ReactNode\r\n  onClick?: (event: MouseEvent) => boolean | void\r\n}\r\n\r\nexport type NavigatorProps = ComponentProps &\r\n  (Partial<NavigateForwardOptions> | NavigateBackOptions)\r\n\r\nexport const Navigator = ({\r\n  className,\r\n  style,\r\n  children,\r\n  title = children,\r\n  onClick,\r\n  ...navigateOptions\r\n}: NavigatorProps) => {\r\n  const { navigator } = useNavigation()\r\n\r\n  let href: string | undefined\r\n\r\n  if (navigateOptions.type !== 'navigateBack') {\r\n    const { name, url } = navigateOptions\r\n    const to = name ? { name } : url\r\n\r\n    if (to) {\r\n      href = navigator.createHref(to)\r\n    }\r\n  }\r\n\r\n  const handleNavigate = (event: MouseEvent) => {\r\n    const keepGoing = onClick?.(event)\r\n\r\n    if (keepGoing === false) {\r\n      event.preventDefault()\r\n      return\r\n    }\r\n\r\n    if (event.button === 0 && !isModifiedEvent(event)) {\r\n      event.preventDefault()\r\n      navigate({\r\n        navigator,\r\n        type: 'navigateTo',\r\n        ...navigateOptions\r\n      })\r\n    }\r\n  }\r\n\r\n  return (\r\n    <a\r\n      className={className}\r\n      href={href}\r\n      style={style}\r\n      target='_self'\r\n      onClick={handleNavigate}\r\n    >\r\n      {title}\r\n    </a>\r\n  )\r\n}\r\n","import { useRef } from 'react'\r\n\r\nimport {\r\n  navigate,\r\n  NavigateBackOptions,\r\n  NavigateForwardOptions\r\n} from '../core/navigate'\r\n\r\nimport { useNavigation } from './useNavigation'\r\n\r\nexport type NavigateToParams = Pick<NavigateForwardOptions, 'name' | 'url'>\r\nexport type RedirectToParams = NavigateToParams\r\nexport type SwitchTabParams = NavigateToParams\r\nexport type NavigateBackParams = Pick<NavigateBackOptions, 'delta'>\r\n\r\nexport type RouterNavigator = {\r\n  navigateTo: (options: NavigateToParams) => Promise<void>\r\n  redirectTo: (options: RedirectToParams) => Promise<void>\r\n  switchTab: (options: SwitchTabParams) => Promise<void>\r\n  navigateBack: (options: NavigateBackParams) => Promise<void>\r\n}\r\n\r\nexport const useRouter = () => {\r\n  const ref = useRef<RouterNavigator>()\r\n  const { navigator } = useNavigation()\r\n\r\n  if (!ref.current) {\r\n    ref.current = {\r\n      navigateTo: (options: NavigateToParams) => {\r\n        return navigate({ navigator, type: 'navigateTo', ...options })\r\n      },\r\n\r\n      redirectTo: (options: RedirectToParams) => {\r\n        return navigate({ navigator, type: 'redirectTo', ...options })\r\n      },\r\n\r\n      switchTab: (options: SwitchTabParams) => {\r\n        return navigate({ navigator, type: 'switchTab', ...options })\r\n      },\r\n\r\n      navigateBack: (options: NavigateBackParams) => {\r\n        return navigate({ navigator, type: 'navigateBack', ...options })\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    ...(ref.current as RouterNavigator),\r\n    currentRoute: navigator.currentRoute,\r\n    getSnapshoot() {\r\n      return navigator.stackSnapshoot\r\n    }\r\n  }\r\n}\r\n","import { useContext } from 'react'\r\n\r\nimport { LocationContext } from '../context/LocationContext'\r\n\r\nexport const useLocation = () => {\r\n  return useContext(LocationContext)\r\n}\r\n","import { useContext } from 'react'\r\nimport { PageContext } from 'src/context/PageContext'\r\n\r\nexport const usePage = () => {\r\n  return useContext(PageContext)\r\n}\r\n","import { useRef } from 'react'\r\nimport { PageStatus } from 'src/context/PageContext'\r\nimport { Noop } from 'src/utils/function'\r\nimport { usePage } from './usePage'\r\n\r\nexport const useDidHide = (cb: Noop<never>) => {\r\n  const { status } = usePage()\r\n\r\n  const ref = useRef<PageStatus>()\r\n\r\n  if (status === 'hide' && ref.current !== 'hide') {\r\n    cb()\r\n  }\r\n\r\n  ref.current = status\r\n}\r\n","import { useRef } from 'react'\r\nimport { PageStatus } from 'src/context/PageContext'\r\nimport { Noop } from 'src/utils/function'\r\nimport { usePage } from './usePage'\r\n\r\nexport const useDidShow = (cb: Noop<never>) => {\r\n  const { status } = usePage()\r\n\r\n  const ref = useRef<PageStatus>()\r\n\r\n  if (status === 'show' && ref.current !== 'show') {\r\n    cb()\r\n  }\r\n\r\n  ref.current = status\r\n}\r\n","import { Route } from './core/route'\r\n\r\nexport {\r\n  BrowserRouter,\r\n  HashRouter,\r\n  type BrowserRouterProps,\r\n  type HashRouterProps\r\n} from './core/Router'\r\nexport {\r\n  type Route,\r\n  isPageRoute,\r\n  isTabRoute,\r\n  isSameRoute,\r\n  matchRoute\r\n} from './core/route'\r\nexport { Navigator, type NavigatorProps } from './core/Navigator'\r\n\r\nexport { useRouter, type RouterNavigator } from './hooks/useRouter'\r\nexport { useLocation } from './hooks/useLocation'\r\nexport { useDidHide } from './hooks/useDidHide'\r\nexport { useDidShow } from './hooks/useDidShow'\r\n\r\nexport const defineRoutes = (routes: Route[]) => routes\r\n"],"names":["createContext","_jsx","parsePath","createPath","useState","useCallback","useMemo","useEffect","useRef","history","createBrowserHistory","createHashHistory","useContext"],"mappings":";;;;;;;;AAQO,MAAM,eAAe,GAAGA,mBAAa,CAAuB,EAAS,CAAC,CAAA;AAEtE,MAAM,gBAAgB,GAAG,CAC9B,KAA0C,KACxC;AACF,IAAA,OAAOC,eAAC,eAAe,CAAC,QAAQ,EAAK,EAAA,GAAA,KAAK,GAAI,CAAA;AAChD,CAAC;;ACNM,MAAM,iBAAiB,GAAGD,mBAAa,CAC5C,EAAS,CACV,CAAA;AAEM,MAAM,kBAAkB,GAAG,CAChC,KAA4C,KAC1C;AACF,IAAA,OAAOC,eAAC,iBAAiB,CAAC,QAAQ,EAAK,EAAA,GAAA,KAAK,GAAI,CAAA;AAClD,CAAC;;ACdM,MAAM,gBAAgB,GAAG,CAAC,SAAc,KAAI;IACjD,OAAO,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,gBAAgB,CAAA;AAC7D,CAAC,CAAA;AAED,MAAM,YAAY,GAAG,aAAa,CAAA;AAC3B,MAAM,eAAe,GAAG,CAAC,SAAc,KAAgC;AAC5E,IAAA,IAAI,gBAAgB,CAAC,SAAS,CAAC,EAAE;AAC/B,QAAA,OAAO,KAAK,CAAA;AACb,KAAA;IAED,MAAM,GAAG,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,EAAE,CAAA;IAEpC,OAAO,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;AAC5E,CAAC,CAAA;AAEM,MAAM,iBAAiB,GAAG,OAAO,SAA6B,KAAI;AACvE,IAAA,MAAM,GAAG,GAAG,MAAM,SAAS,EAAE,CAAA;AAE7B,IAAA,IAAI,GAAG,IAAI,UAAU,CAAC,GAAG,CAAC,EAAE;QAC1B,OAAO,GAAG,CAAC,OAAO,CAAA;AACnB,KAAA;AAED,IAAA,OAAO,GAAG,CAAA;AACZ,CAAC,CAAA;AAEM,MAAM,UAAU,GAAG,CAAC,GAAQ,KAA6B;AAC9D,IAAA,OAAO,GAAG,CAAC,UAAU,KAAK,SAAS,IAAI,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC,KAAK,QAAQ,CAAC,CAAA;AAC9E,CAAC,CAAA;AAEM,MAAM,SAAS,GACpB,OAAO,MAAM,KAAK,UAAU,IAAI,OAAO,MAAM,CAAC,WAAW,KAAK,QAAQ;;AChCjE,MAAM,QAAQ,GAAG,UAAU;;ACAlC,IAAI,GAAG,GAAG,EAAE,EACV,GAAG,GAAG,EAAE,CAAA;AACV,OAAO,GAAG,EAAE;AAAE,IAAA,GAAG,IAAI,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAA;AAE/B,SAAU,GAAG,CAAC,GAAY,EAAA;IAC9B,IAAI,GAAG,GAAG,EAAE,EACV,GAAG,GAAG,GAAG,IAAI,EAAE,CAAA;AACjB,IAAA,OAAO,GAAG,EAAE;AAAE,QAAA,GAAG,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC,CAAA;AAClD,IAAA,OAAO,GAAG,CAAA;AACZ;;ACJO,MAAM,eAAe,GAAG,CAAC,QAAgB,EAAE,QAAgB,KAAI;AACpE,IAAA,OAAO,QAAQ,CAAC,WAAW,EAAE,CAAC,UAAU,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAA;AAClE,CAAC,CAAA;AAEM,MAAM,aAAa,GAAG,CAAC,QAAgB,EAAE,QAAgB,KAAI;IAClE,IAAI,QAAQ,KAAK,GAAG;AAAE,QAAA,OAAO,QAAQ,CAAA;AAErC,IAAA,IAAI,CAAC,eAAe,CAAC,QAAQ,EAAE,QAAQ,CAAC,EAAE;AACxC,QAAA,OAAO,IAAI,CAAA;AACZ,KAAA;IAED,OAAO,QAAQ,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,GAAG,CAAA;AAC/C,CAAC,CAAA;AAEM,MAAM,SAAS,GAAG,CAAC,GAAG,KAAe,KAAI;AAC9C,IAAA,OAAO,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAA;AAC/C,CAAC,CAAA;AAEM,MAAM,aAAa,GAAG,CAAC,QAAgB,KAAI;AAChD,IAAA,OAAO,QAAQ,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CAAA;AAC1D,CAAC,CAAA;AAEM,MAAM,WAAW,GAAG,CAAC,GAAY,KAAI;IAC1C,MAAM,MAAM,GAA2B,EAAE,CAAA;IAEzC,IAAI,CAAC,GAAG,EAAE;AACR,QAAA,OAAO,MAAM,CAAA;AACd,KAAA;IAED,MAAM,EAAE,MAAM,EAAE,GAAGC,iBAAS,CAAC,GAAG,CAAC,CAAA;AACjC,IAAA,MAAM,YAAY,GAAG,IAAI,eAAe,CAAC,MAAM,CAAC,CAAA;IAEhD,KAAK,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,YAAY,CAAC,OAAO,EAAE,EAAE;AACjD,QAAA,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK,CAAA;AACpB,KAAA;AAED,IAAA,OAAO,MAAM,CAAA;AACf,CAAC,CAAA;AAEM,MAAM,eAAe,GAAG,CAAC,MAAwB,KAAI;AAC1D,IAAA,MAAM,YAAY,GAAG,IAAI,eAAe,EAAE,CAAA;AAE1C,IAAA,KAAK,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;AACjD,QAAA,YAAY,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,CAAA;AAChC,KAAA;AAED,IAAA,OAAO,YAAY,CAAC,QAAQ,EAAE,CAAA;AAChC,CAAC,CAAA;AAEM,MAAM,UAAU,GAAG,CAAC,EAAE,MAAM,EAAiB,KAAI;IACtD,IAAI,CAAC,MAAM,EAAE;AACX,QAAA,OAAO,SAAS,CAAA;AACjB,KAAA;AAED,IAAA,MAAM,MAAM,GAAG,WAAW,CAAC,MAAM,CAAC,CAAA;AAElC,IAAA,MAAM,OAAO,GAAG,MAAM,CAAC,QAAQ,CAAC,CAAA;AAEhC,IAAA,OAAO,OAAO,OAAO,KAAK,QAAQ,GAAG,OAAO,GAAG,SAAS,CAAA;AAC1D,CAAC,CAAA;AAEM,MAAM,UAAU,GAAG,CAAC,QAAuB,KAAI;IACpD,MAAM,MAAM,GAAG,WAAW,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAA;IAC3C,MAAM,MAAM,GAAG,eAAe,CAAC;AAC7B,QAAA,GAAG,MAAM;AACT,QAAA,CAAC,QAAQ,GAAG,GAAG,EAAE;AAClB,KAAA,CAAC,CAAA;IAEF,OAAO;AACL,QAAA,GAAG,QAAQ;QACX,MAAM;KACP,CAAA;AACH,CAAC;;AC7ED;;;;;AAKM;AAKN,SAAS,GAAG,CAAC,MAAwB,EAAE,IAAS,EAAE,OAAe,EAAA;AAC/D,IAAA,IAAI,IAAI,EAAE;;QAER,IAAI,OAAO,OAAO,KAAK,WAAW;AAAE,YAAA,OAAO,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,CAAA;QAE5D,IAAI;;;;;;AAMF,YAAA,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,CAAA;;AAEzB,SAAA;QAAC,OAAO,CAAC,EAAE,GAAE;AACf,KAAA;AACH,CAAC;AAEe,SAAA,OAAO,CAAC,IAAS,EAAE,OAAe,EAAA;AAChD,IAAA,GAAG,CAAC,MAAM,EAAE,IAAI,EAAE,OAAO,CAAC,CAAA;AAC5B,CAAC;AAEe,SAAA,KAAK,CAAC,IAAS,EAAE,OAAe,EAAA;AAC9C,IAAA,GAAG,CAAC,OAAO,EAAE,IAAI,EAAE,OAAO,CAAC,CAAA;AAC7B;;ACUa,MAAA,UAAU,GAAG,CAAC,KAAe,KAAuB;AAC/D,IAAA,OAAO,KAAK,CAAC,IAAI,KAAK,KAAK,CAAA;AAC7B,EAAC;AAEY,MAAA,WAAW,GAAG,CAAC,KAAe,KAAwB;IACjE,OAAO,KAAK,CAAC,IAAI,KAAK,SAAS,IAAI,KAAK,CAAC,IAAI,KAAK,MAAM,CAAA;AAC1D,EAAC;MAEY,WAAW,GAAG,CAAC,MAAgB,EAAE,MAAgB,KAAI;AAChE,IAAA,OAAO,MAAM,CAAC,IAAI,KAAK,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,KAAK,MAAM,CAAC,IAAI,CAAA;AACnE,EAAC;MAEY,UAAU,GAAG,CAAC,MAAe,EAAE,UAAmB,KAAI;AACjE,IAAA,IAAI,KAAwB,CAAA;AAE5B,IAAA,IAAI,UAAU,EAAE;QACd,KAAK,GAAG,MAAM,CAAC,IAAI,CACjB,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,IAAI,KAAK,UAAU,IAAI,IAAI,KAAK,UAAU,CAC/D,CAAA;AACF,KAAA;IAED,OAAO,CACL,CAAC,KAAK,EACN,kDAAkD,UAAU,CAAA,GAAA,CAAK,CAClE,CAAA;AAED,IAAA,OAAO,KAAK,CAAA;AACd;;MC9Ba,UAAU,CAAA;AACd,IAAA,QAAQ,CAAQ;AACf,IAAA,OAAO,CAAS;AAChB,IAAA,MAAM,CAAS;AACf,IAAA,KAAK,CAAO;AAEZ,IAAA,cAAc,CAA0B;AACxC,IAAA,UAAU,CAAyB;IAEnC,SAAS,GAAkB,EAAE,CAAA;IAC7B,WAAW,GAAW,EAAE,CAAA;IAEhC,WAAY,CAAA,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK,EAAgB,EAAA;AAC5D,QAAA,IAAI,CAAC,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC,CAAA;AACvC,QAAA,IAAI,CAAC,MAAM,GAAG,MAAM,CAAA;AACpB,QAAA,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;AAClB,QAAA,IAAI,CAAC,OAAO,GAAG,OAAO,CAAA;AACtB,QAAA,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,EAAE,CAAA;AAC/B,QAAA,IAAI,CAAC,UAAU,GAAG,IAAI,GAAG,EAAE,CAAA;QAE3B,IAAI,CAAC,cAAc,EAAE,CAAA;QACrB,IAAI,CAAC,WAAW,EAAE,CAAA;QAClB,IAAI,CAAC,aAAa,EAAE,CAAA;KACrB;AAED,IAAA,IAAI,QAAQ,GAAA;AACV,QAAA,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAA;KAC7B;AAED,IAAA,IAAI,YAAY,GAAA;AACd,QAAA,OAAO,IAAI,CAAC,KAAK,CAAC,OAAO,CAAA;KAC1B;AAED,IAAA,IAAI,cAAc,GAAA;QAChB,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,EAAE,CAAA;KAChC;AAED,IAAA,IAAY,UAAU,GAAA;QACpB,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAA;KAC9D;IAEO,MAAM,kBAAkB,CAAC,QAAgB,EAAA;QAC/C,MAAM,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAA;QAE/C,IAAI,CAAC,KAAK,EAAE;YACV,OAAM;AACP,SAAA;AAED,QAAA,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,KAAK,CAAA;QACjC,IAAI,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YACjC,OAAO,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;AACrC,SAAA;AAED,QAAA,IAAI,WAAwB,CAAA;AAE5B,QAAA,IAAI,eAAe,CAAC,SAAS,CAAC,EAAE;AAC9B,YAAA,MAAM,iBAAiB,GAAG,MAAM,iBAAiB,CAAC,SAAS,CAAC,CAAA;YAE5D,IAAI,CAAC,iBAAiB,EAAE;AACtB,gBAAA,MAAM,IAAI,KAAK,CAAC,mCAAmC,IAAI,CAAA,CAAA,CAAG,CAAC,CAAA;AAC5D,aAAA;AAED,YAAA,WAAW,GAAG;AACZ,gBAAA,GAAG,KAAK;AACR,gBAAA,SAAS,EAAE,iBAAiB;aAC7B,CAAA;AACF,SAAA;AAAM,aAAA;AACL,YAAA,WAAW,GAAG;AACZ,gBAAA,GAAG,KAAK;gBACR,SAAS;aACV,CAAA;AACF,SAAA;QAED,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,IAAI,EAAE,WAAW,CAAC,CAAA;AAE1C,QAAA,OAAO,WAAW,CAAA;KACnB;AAED;;AAEG;IACK,cAAc,GAAA;AACpB,QAAA,MAAM,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,OAAM,OAAO,KAAG;YACrD,MAAM,EACJ,QAAQ,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,EAC9B,GAAG,OAAO,CAAA;YAEX,MAAM,IAAI,GAAG,aAAa,CAAC,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAA;YAEnD,IAAI,CAAC,IAAI,EAAE;gBACT,OAAM;AACP,aAAA;YAED,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAA;YAEjD,IAAI,CAAC,KAAK,EAAE;gBACV,OAAM;AACP,aAAA;AAED,YAAA,MAAM,UAAU,GAAG;AACjB,gBAAA,GAAG,OAAO;gBACV,KAAK;aACN,CAAA;AAED,YAAA,IAAI,KAAK,EAAE;AACT,gBAAA,MAAM,EAAE,SAAS,EAAE,GAAG,KAAiB,CAAA;gBAEvC,MAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,CAAA;gBAE9C,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,CAAC,KAAK,KAAK,EAAE;AAC5C,oBAAA,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAA;oBACjC,OAAM;AACP,iBAAA;AACF,aAAA;AAED,YAAA,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,IAAG;gBAC9B,MAAM,CAAC,UAAU,CAAC,CAAA;AACpB,aAAC,CAAC,CAAA;AACJ,SAAC,CAAC,CAAA;AAEF,QAAA,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;KAClC;AAED;;AAEG;IACK,WAAW,GAAA;QACjB,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAI;AAClC,YAAA,MAAM,GAAG,GAAGC,kBAAU,CAAC,QAAQ,CAAC,CAAA;AAEhC,YAAA,MAAM,OAAO,GAAG,UAAU,CAAC,QAAQ,CAAC,CAAA;AAEpC,YAAA,IAAI,OAAO,EAAE;AACX,gBAAA,MAAM,UAAU,GAAG;oBACjB,OAAO;oBACP,GAAG;AACH,oBAAA,GAAG,KAAK;iBACT,CAAA;AAED,gBAAA,IAAI,UAAU,CAAC,KAAK,CAAC,EAAE;AACrB,oBAAA,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,CAAA;AACjC,iBAAA;AAAM,qBAAA;AACL,oBAAA,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAA;AAChC,iBAAA;AACF,aAAA;AAAM,iBAAA;gBACL,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAA;AAC3C,aAAA;AACH,SAAC,CAAC,CAAA;KACH;AAED;;AAEG;IACK,aAAa,GAAA;QACnB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAA;KACnC;AAED,IAAA,MAAM,CAAC,QAAqB,EAAA;AAC1B,QAAA,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;QAE7B,MAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAA;AAEvC,QAAA,OAAO,MAAK;YACV,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAA;AACjC,SAAC,CAAA;KACF;AAEO,IAAA,SAAS,CAAC,EAAS,EAAA;AACzB,QAAA,IAAI,IAA+B,CAAA;AAEnC,QAAA,IAAI,OAAO,EAAE,KAAK,QAAQ,EAAE;AAC1B,YAAA,IAAI,GAAGD,iBAAS,CAAC,EAAE,CAAC,CAAA;AACrB,SAAA;aAAM,IAAI,UAAU,IAAI,EAAE,EAAE;YAC3B,IAAI,GAAG,EAAE,CAAA;AACV,SAAA;aAAM,IAAI,MAAM,IAAI,EAAE,EAAE;AACvB,YAAA,MAAM,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC,MAAM,EAAE,EAAE,CAAC,IAAI,CAAC,CAAA;AAE9C,YAAA,IAAI,GAAG,KAAK;AACV,kBAAE;oBACE,QAAQ,EAAE,KAAK,CAAC,IAAI;AACrB,iBAAA;kBACD,SAAS,CAAA;AACd,SAAA;QAED,IAAI,IAAI,EAAE,QAAQ,EAAE;AAClB,YAAA,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAA;AACvD,YAAA,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC,CAAA;AACxB,SAAA;AAED,QAAA,OAAO,IAAI,CAAA;KACZ;IAED,IAAI,CAAC,EAAS,EAAE,OAAoB,EAAA;QAClC,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAA;AAEjC,QAAA,IAAI,MAAM,EAAE;AACV,YAAA,IAAI,KAAK,CAAA;AACT,YAAA,IAAI,OAAO,EAAE;AACX,gBAAA,MAAM,SAAS,GAAG,IAAI,CAAC,GAAG,EAAE,CAAA;AAC5B,gBAAA,KAAK,GAAG,EAAE,SAAS,EAAE,CAAA;gBACrB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,EAAE,OAAO,CAAC,CAAA;AACxC,aAAA;YAED,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;AACjC,SAAA;KACF;AAED,IAAA,OAAO,CAAC,EAAS,EAAA;QACf,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAA;AAEjC,QAAA,IAAI,MAAM,EAAE;AACV,YAAA,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,CAAA;AAChB,YAAA,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;AAC7B,SAAA;KACF;IAED,KAAK,GAAA;AACH,QAAA,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAA;KACnB;IAED,IAAI,CAAC,KAAK,GAAG,CAAC,EAAA;QACZ,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAA;QAE7C,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;KAClC;AAED,IAAA,UAAU,CAAC,EAAS,EAAA;QAClB,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAA;AAEjC,QAAA,IAAI,MAAM,EAAE;YACV,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,CAAA;AACvC,SAAA;AAED,QAAA,OAAO,SAAS,CAAA;KACjB;IAED,OAAO,GAAA;AACL,QAAA,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,IAAI,IAAI,EAAE,CAAC,CAAA;KACzC;AACF;;ACrRD,IAAI,KAAU,CAAA;AACP,MAAM,QAAQ,GAAG,CAAC,EAAQ,EAAE,IAAY,KAAI;AACjD,IAAA,IAAI,KAAK,EAAE;QACT,YAAY,CAAC,KAAK,CAAC,CAAA;AACpB,KAAA;AAED,IAAA,KAAK,GAAG,UAAU,CAAC,EAAE,EAAE,IAAI,CAAC,CAAA;AAC9B,CAAC;;ACID,MAAM,mBAAmB,GAAG,CAAC,SAAoB,KAAI;IACnD,MAAM,OAAO,GAAiB,EAAE,CAAA;AAEhC,IAAA,OAAO,IAAI,KAAK,CAAC,OAAO,EAAE;QACxB,GAAG,CAAC,MAAM,EAAE,GAAQ,EAAA;AAClB,YAAA,OAAO,MAAM,CAAC,GAAG,CAAC,CAAA;SACnB;AACD,QAAA,GAAG,CAAC,MAAM,EAAE,GAAQ,EAAE,KAAK,EAAA;AACzB,YAAA,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK,CAAA;AAEnB,YAAA,QAAQ,CAAC,SAAS,EAAE,EAAE,CAAC,CAAA;AAEvB,YAAA,OAAO,IAAI,CAAA;SACZ;AACF,KAAA,CAAC,CAAA;AACJ,CAAC,CAAA;MAEY,KAAK,CAAA;AACR,IAAA,IAAI,CAAc;AAClB,IAAA,KAAK,CAAc;AAE3B,IAAA,WAAA,CAAY,SAAoB,EAAA;AAC9B,QAAA,IAAI,CAAC,IAAI,GAAG,mBAAmB,CAAC,SAAS,CAAC,CAAA;AAC1C,QAAA,IAAI,CAAC,KAAK,GAAG,mBAAmB,CAAC,SAAS,CAAC,CAAA;KAC5C;AAED,IAAA,IAAI,OAAO,GAAA;AACT,QAAA,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA;KACzC;AAED,IAAA,IAAI,KAAK,GAAA;QACP,OAAO,CAAC,GAAG,IAAI,CAAC,IAAI,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,CAAA;KACrC;AAEO,IAAA,WAAW,CAAC,IAAgB,EAAA;AAClC,QAAA,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,WAAW,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC,CAAA;KACrD;AAEO,IAAA,aAAa,CAAC,IAAgB,EAAA;AACpC,QAAA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;YACjB,OAAO,CAAC,CAAC,CAAA;AACV,SAAA;AAED,QAAA,OAAO,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,IAAI,IAAI,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO,CAAC,CAAA;KACnE;AAED;;AAEG;AACH,IAAA,WAAW,CAAC,KAAa,EAAA;AACvB,QAAA,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,KAAK,GAAG,CAAC,CAAC,CAAA;KACjD;AAED,IAAA,SAAS,CAAC,IAAgB,EAAA;AACxB,QAAA,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE;YAC1B,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,KAAK,WAAW,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;AACzD,SAAA;AAAM,aAAA;YACL,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,GAAG,IAAI,EAAE,CAAC,CAAA;AAC5B,SAAA;QAED,IAAI,CAAC,KAAK,EAAE,CAAA;KACb;AAED,IAAA,QAAQ,CAAC,IAAgB,EAAA;QACvB,MAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAA;AAE1C,QAAA,IAAI,SAAS,GAAG,CAAC,CAAC,EAAE;AAClB,YAAA,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,SAAS,GAAG,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,SAAS,GAAG,CAAC,CAAC,CAAA;AACpE,SAAA;AAAM,aAAA;YACL,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,GAAG,IAAI,EAAE,CAAC,CAAA;AAC7B,SAAA;KACF;IAED,GAAG,GAAA;AACD,QAAA,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,CAAA;KACjB;IAED,KAAK,GAAA;AACH,QAAA,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;KACxC;AACF;;AC3FM,MAAM,cAAc,GAAG,MAAK;IACjC,MAAM,GAAG,QAAQ,CAAC,GAAGE,cAAQ,CAAC,EAAE,CAAC,CAAA;AAEjC,IAAA,OAAOC,iBAAW,CAAC,MAAM,QAAQ,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAA;AAC5C,CAAC;;ACAM,MAAM,QAAQ,GAAG,MAAK;AAC3B,IAAA,MAAM,SAAS,GAAG,cAAc,EAAE,CAAA;AAElC,IAAA,OAAOC,aAAO,CAAC,MAAM,IAAI,KAAK,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC,CAAA;AAChD,CAAC;;ACRM,MAAM,UAAU,GAAG,CAAC,EAAc,KAAI;IAC3CC,eAAS,CAAC,MAAK;AACb,QAAA,OAAO,EAAE,CAAA;KACV,EAAE,EAAE,CAAC,CAAA;AACR,CAAC;;ACUM,MAAM,QAAQ,GAAG,CAAC,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAmB,KAAI;AACzE,IAAA,MAAM,KAAK,GAAG,QAAQ,EAAE,CAAA;;AAGxB,IAAA,MAAM,GAAG,GAAGC,YAAM,EAAc,CAAA;AAEhC,IAAA,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;AAChB,QAAA,GAAG,CAAC,OAAO,GAAG,IAAI,UAAU,CAAC,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC,CAAA;AACnE,KAAA;AAED,IAAA,MAAM,UAAU,GAAG,GAAG,CAAC,OAAO,CAAA;AAE9B,IAAA,MAAM,CAAC,QAAQ,EAAE,WAAW,CAAC,GAAGJ,cAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAA;IAE1DG,eAAS,CAAC,MAAK;QACb,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,EAAE,QAAQ,EAAE,EAAA;YACvC,WAAW,CAAC,QAAQ,CAAC,CAAA;AACvB,SAAC,CAAC,CAAA;AACJ,KAAC,EAAE,CAAC,UAAU,CAAC,CAAC,CAAA;IAEhB,UAAU,CAAC,MAAK;QACd,UAAU,CAAC,OAAO,EAAE,CAAA;AACtB,KAAC,CAAC,CAAA;IAEF,OAAO;QACL,QAAQ;AACR,QAAA,OAAO,EAAE,UAAU;QACnB,OAAO,EAAE,KAAK,CAAC,KAAK;KACrB,CAAA;AACH,CAAC;;ACrCM,MAAM,WAAW,GAAGP,mBAAa,CAAmB,EAAE,CAAC;;ACA9D,MAAM,SAAS,GAAkB,MAAM,CAAC,MAAM,CAAC;AAC7C,IAAA,OAAO,EAAE,MAAM;AAChB,CAAA,CAAC,CAAA;AAEF,MAAM,UAAU,GAAG,CAAC,EAAE,MAAM,EAAE,QAAQ,EAAmB,KAAI;AAC3D,IAAA,QACEC,cAAA,CAAC,WAAW,CAAC,QAAQ,EAAC,EAAA,KAAK,EAAE,EAAE,MAAM,EAAE,EACrC,QAAA,EAAAA,cAAA,CAAA,KAAA,EAAA,EACE,QAAQ,EAAE,QAAQ,EAClB,KAAK,EAAE,MAAM,KAAK,MAAM,GAAG,SAAS,GAAG,SAAS,EAChD,CAAA,EAAA,CACmB,EACxB;AACH,CAAC;;ACHD,MAAM,YAAY,GAAG,CAAC,MAAoB,KAAI;AAC5C,IAAA,OAAO,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,EAAE,SAAS,EAAE,cAAc,EAAE,EAAE,KAAK,KAAI;AAClE,QAAA,MAAM,MAAM,GAAG,KAAK,KAAK,MAAM,CAAC,MAAM,GAAG,CAAC,GAAG,MAAM,GAAG,MAAM,CAAA;AAC5D,QAAA,QACEA,cAAA,CAAC,UAAU,EAAA,EAAe,MAAM,EAAE,MAAM,EACtC,QAAA,EAAAA,cAAA,CAAC,cAAc,EAAG,EAAA,CAAA,EAAA,EADH,OAAO,CAEX,EACd;AACH,KAAC,CAAC,CAAA;AACJ,CAAC,CAAA;AAEM,MAAM,MAAM,GAAG,CAAC,EAAE,QAAQ,GAAG,GAAG,EAAE,OAAO,EAAE,MAAM,EAAe,KAAI;IACzE,MAAM,EACJ,OAAO,EACP,QAAQ,EACR,OAAO,EAAE,UAAU,EACpB,GAAG,QAAQ,CAAC,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,CAAA;AAE3C,IAAA,MAAM,QAAQ,GAAG,YAAY,CAAC,OAAO,CAAC,CAAA;IAEtC,QACEA,cAAC,CAAA,kBAAkB,EAAC,EAAA,KAAK,EAAE,EAAE,SAAS,EAAE,UAAU,EAAE,EAClD,QAAA,EAAAA,cAAA,CAAC,gBAAgB,EAAA,EAAC,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,EAAE,QAAQ,EAAE,EAAA,CAAI,EAC1C,CAAA,EACtB;AACH,CAAC,CAAA;AAOY,MAAA,aAAa,GAAG,CAAC,EAAE,QAAQ,EAAE,MAAM,EAAsB,KAAI;AACxE,IAAA,MAAMQ,SAAO,GAAGH,aAAO,CAAC,MAAMI,4BAAoB,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC,CAAA;AAEnE,IAAA,OAAOT,cAAC,CAAA,MAAM,EAAC,EAAA,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAEQ,SAAO,EAAE,MAAM,EAAE,MAAM,GAAI,CAAA;AACzE,EAAC;AAIY,MAAA,UAAU,GAAG,CAAC,EAAE,QAAQ,EAAE,MAAM,EAAmB,KAAI;AAClE,IAAA,MAAMA,SAAO,GAAGH,aAAO,CAAC,MAAMK,yBAAiB,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC,CAAA;AAEhE,IAAA,OAAOV,cAAC,CAAA,MAAM,EAAC,EAAA,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAEQ,SAAO,EAAE,MAAM,EAAE,MAAM,GAAI,CAAA;AACzE;;AC1DO,MAAM,aAAa,GAAG,MAAK;AAChC,IAAA,OAAOG,gBAAU,CAAC,iBAAiB,CAAC,CAAA;AACtC,CAAC;;ACJM,MAAM,eAAe,GAAG,CAAC,KAAiB,KAAI;AACnD,IAAA,OAAO,CAAC,EAAE,KAAK,CAAC,OAAO,IAAI,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,OAAO,IAAI,KAAK,CAAC,QAAQ,CAAC,CAAA;AAC7E,CAAC;;ACgBM,MAAM,QAAQ,GAAG,OAAO,OAAwB,KAAI;IACzD,OAAO,IAAI,OAAO,CAAO,CAAC,OAAO,EAAE,MAAM,KAAI;AAC3C,QAAA,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,CAAA;AAEnC,QAAA,MAAM,QAAQ,GAAG,SAAS,CAAC,MAAM,CAAC,MAAK;AACrC,YAAA,OAAO,EAAE,CAAA;AACT,YAAA,QAAQ,EAAE,CAAA;AACZ,SAAC,CAAC,CAAA;QAEF,IAAI;YACF,IAAI,IAAI,KAAK,cAAc,EAAE;AAC3B,gBAAA,MAAM,EAAE,KAAK,EAAE,GAAG,OAAO,CAAA;AAEzB,gBAAA,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;AACtB,aAAA;AAAM,iBAAA;AACL,gBAAA,MAAM,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,OAAO,CAAA;AAC7B,gBAAA,MAAM,EAAE,GAAG,IAAI,GAAG,EAAE,IAAI,EAAE,GAAG,GAAG,CAAA;gBAEhC,IAAI,CAAC,EAAE,EAAE;oBACP,OAAM;AACP,iBAAA;AAED,gBAAA,IAAI,IAAI,KAAK,YAAY,IAAI,IAAI,KAAK,WAAW,EAAE;oBACjD,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,EAAE,KAAK,EAAE,KAAI;wBAC/B,IAAI,IAAI,KAAK,YAAY,IAAI,UAAU,CAAC,KAAK,CAAC,EAAE;4BAC9C,KAAK,CACH,IAAI,EACJ,CAAA,qEAAA,EAAwE,KAAK,CAAC,IAAI,CAAE,CAAA,CACrF,CAAA;AAED,4BAAA,OAAO,KAAK,CAAA;AACb,yBAAA;AACH,qBAAC,CAAC,CAAA;AACH,iBAAA;qBAAM,IAAI,IAAI,KAAK,YAAY,EAAE;AAChC,oBAAA,SAAS,CAAC,OAAO,CAAC,EAAE,CAAC,CAAA;AACtB,iBAAA;qBAAM,IAAI,IAAI,KAAK,UAAU,EAAE;oBAC9B,SAAS,CAAC,KAAK,EAAE,CAAA;AACjB,oBAAA,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;AACnB,iBAAA;AACF,aAAA;AACF,SAAA;AAAC,QAAA,OAAO,KAAU,EAAE;YACnB,MAAM,CAAC,CAAG,EAAA,IAAI,CAAS,MAAA,EAAA,KAAK,CAAC,OAAO,IAAI,KAAK,CAAE,CAAA,CAAC,CAAA;AACjD,SAAA;AACH,KAAC,CAAC,CAAA;AACJ,CAAC;;MC1CY,SAAS,GAAG,CAAC,EACxB,SAAS,EACT,KAAK,EACL,QAAQ,EACR,KAAK,GAAG,QAAQ,EAChB,OAAO,EACP,GAAG,eAAe,EACH,KAAI;AACnB,IAAA,MAAM,EAAE,SAAS,EAAE,GAAG,aAAa,EAAE,CAAA;AAErC,IAAA,IAAI,IAAwB,CAAA;AAE5B,IAAA,IAAI,eAAe,CAAC,IAAI,KAAK,cAAc,EAAE;AAC3C,QAAA,MAAM,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,eAAe,CAAA;AACrC,QAAA,MAAM,EAAE,GAAG,IAAI,GAAG,EAAE,IAAI,EAAE,GAAG,GAAG,CAAA;AAEhC,QAAA,IAAI,EAAE,EAAE;AACN,YAAA,IAAI,GAAG,SAAS,CAAC,UAAU,CAAC,EAAE,CAAC,CAAA;AAChC,SAAA;AACF,KAAA;AAED,IAAA,MAAM,cAAc,GAAG,CAAC,KAAiB,KAAI;AAC3C,QAAA,MAAM,SAAS,GAAG,OAAO,GAAG,KAAK,CAAC,CAAA;QAElC,IAAI,SAAS,KAAK,KAAK,EAAE;YACvB,KAAK,CAAC,cAAc,EAAE,CAAA;YACtB,OAAM;AACP,SAAA;QAED,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,EAAE;YACjD,KAAK,CAAC,cAAc,EAAE,CAAA;AACtB,YAAA,QAAQ,CAAC;gBACP,SAAS;AACT,gBAAA,IAAI,EAAE,YAAY;AAClB,gBAAA,GAAG,eAAe;AACnB,aAAA,CAAC,CAAA;AACH,SAAA;AACH,KAAC,CAAA;IAED,QACEX,cACE,CAAA,GAAA,EAAA,EAAA,SAAS,EAAE,SAAS,EACpB,IAAI,EAAE,IAAI,EACV,KAAK,EAAE,KAAK,EACZ,MAAM,EAAC,OAAO,EACd,OAAO,EAAE,cAAc,EAEtB,QAAA,EAAA,KAAK,EACJ,CAAA,EACL;AACH;;AClDO,MAAM,SAAS,GAAG,MAAK;AAC5B,IAAA,MAAM,GAAG,GAAGO,YAAM,EAAmB,CAAA;AACrC,IAAA,MAAM,EAAE,SAAS,EAAE,GAAG,aAAa,EAAE,CAAA;AAErC,IAAA,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;QAChB,GAAG,CAAC,OAAO,GAAG;AACZ,YAAA,UAAU,EAAE,CAAC,OAAyB,KAAI;AACxC,gBAAA,OAAO,QAAQ,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,YAAY,EAAE,GAAG,OAAO,EAAE,CAAC,CAAA;aAC/D;AAED,YAAA,UAAU,EAAE,CAAC,OAAyB,KAAI;AACxC,gBAAA,OAAO,QAAQ,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,YAAY,EAAE,GAAG,OAAO,EAAE,CAAC,CAAA;aAC/D;AAED,YAAA,SAAS,EAAE,CAAC,OAAwB,KAAI;AACtC,gBAAA,OAAO,QAAQ,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,WAAW,EAAE,GAAG,OAAO,EAAE,CAAC,CAAA;aAC9D;AAED,YAAA,YAAY,EAAE,CAAC,OAA2B,KAAI;AAC5C,gBAAA,OAAO,QAAQ,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,cAAc,EAAE,GAAG,OAAO,EAAE,CAAC,CAAA;aACjE;SACF,CAAA;AACF,KAAA;IAED,OAAO;QACL,GAAI,GAAG,CAAC,OAA2B;QACnC,YAAY,EAAE,SAAS,CAAC,YAAY;QACpC,YAAY,GAAA;YACV,OAAO,SAAS,CAAC,cAAc,CAAA;SAChC;KACF,CAAA;AACH;;ACjDO,MAAM,WAAW,GAAG,MAAK;AAC9B,IAAA,OAAOI,gBAAU,CAAC,eAAe,CAAC,CAAA;AACpC;;ACHO,MAAM,OAAO,GAAG,MAAK;AAC1B,IAAA,OAAOA,gBAAU,CAAC,WAAW,CAAC,CAAA;AAChC,CAAC;;ACAY,MAAA,UAAU,GAAG,CAAC,EAAe,KAAI;AAC5C,IAAA,MAAM,EAAE,MAAM,EAAE,GAAG,OAAO,EAAE,CAAA;AAE5B,IAAA,MAAM,GAAG,GAAGJ,YAAM,EAAc,CAAA;IAEhC,IAAI,MAAM,KAAK,MAAM,IAAI,GAAG,CAAC,OAAO,KAAK,MAAM,EAAE;AAC/C,QAAA,EAAE,EAAE,CAAA;AACL,KAAA;AAED,IAAA,GAAG,CAAC,OAAO,GAAG,MAAM,CAAA;AACtB;;ACVa,MAAA,UAAU,GAAG,CAAC,EAAe,KAAI;AAC5C,IAAA,MAAM,EAAE,MAAM,EAAE,GAAG,OAAO,EAAE,CAAA;AAE5B,IAAA,MAAM,GAAG,GAAGA,YAAM,EAAc,CAAA;IAEhC,IAAI,MAAM,KAAK,MAAM,IAAI,GAAG,CAAC,OAAO,KAAK,MAAM,EAAE;AAC/C,QAAA,EAAE,EAAE,CAAA;AACL,KAAA;AAED,IAAA,GAAG,CAAC,OAAO,GAAG,MAAM,CAAA;AACtB;;ACOa,MAAA,YAAY,GAAG,CAAC,MAAe,KAAK;;;;;;;;;;;;;;;"}